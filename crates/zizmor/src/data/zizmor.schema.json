{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "zizmor configuration",
    "description": "Configuration file for zizmor, a static analysis tool for GitHub Actions\nhttps://docs.zizmor.sh/configuration/",
    "type": "object",
    "properties": {
      "rules": {
        "description": "Configuration for individual audit rules.",
        "anyOf": [
          {
            "$ref": "#/definitions/RulesConfig"
          },
          {
            "type": "null"
          }
        ]
      }
    },
    "additionalProperties": false,
    "definitions": {
      "BaseRuleConfig": {
        "description": "Base rule configuration for audits without custom config options.",
        "type": "object",
        "properties": {
          "disable": {
            "description": "Disables the audit entirely if true.",
            "type": [
              "boolean",
              "null"
            ]
          },
          "ignore": {
            "description": "A list of ignore rules for findings from this audit. Each rule is in the format: `filename.yml`, `filename.yml:line`, or `filename.yml:line:col`",
            "type": [
              "array",
              "null"
            ],
            "items": {
              "$ref": "#/definitions/WorkflowRule"
            }
          }
        },
        "additionalProperties": false
      },
      "DependabotCooldownConfig": {
        "description": "Configuration specific to the `dependabot-cooldown` audit.",
        "type": "object",
        "properties": {
          "days": {
            "description": "The cooldown period in days before considering a Dependabot update stale. Default: 7",
            "type": [
              "integer",
              "null"
            ],
            "format": "uint64",
            "minimum": 0.0
          }
        },
        "additionalProperties": false
      },
      "DependabotCooldownRuleConfig": {
        "description": "Rule configuration for the `dependabot-cooldown` audit.",
        "type": "object",
        "properties": {
          "config": {
            "description": "Audit-specific configuration.",
            "anyOf": [
              {
                "$ref": "#/definitions/DependabotCooldownConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "disable": {
            "type": [
              "boolean",
              "null"
            ]
          },
          "ignore": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "$ref": "#/definitions/WorkflowRule"
            }
          }
        },
        "additionalProperties": false
      },
      "ForbiddenUsesAllowConfig": {
        "description": "Configuration for `forbidden-uses` audit (allow mode).",
        "type": "object",
        "required": [
          "allow"
        ],
        "properties": {
          "allow": {
            "description": "List of action patterns to allow (all others are forbidden).",
            "type": "array",
            "items": {
              "$ref": "#/definitions/RepositoryUsesPattern"
            }
          }
        },
        "additionalProperties": false
      },
      "ForbiddenUsesConfig": {
        "description": "Configuration for the `forbidden-uses` audit. Specify either `allow` or `deny`, not both.",
        "anyOf": [
          {
            "$ref": "#/definitions/ForbiddenUsesAllowConfig"
          },
          {
            "$ref": "#/definitions/ForbiddenUsesDenyConfig"
          }
        ]
      },
      "ForbiddenUsesDenyConfig": {
        "description": "Configuration for `forbidden-uses` audit (deny mode).",
        "type": "object",
        "required": [
          "deny"
        ],
        "properties": {
          "deny": {
            "description": "List of action patterns to forbid (all others are allowed).",
            "type": "array",
            "items": {
              "$ref": "#/definitions/RepositoryUsesPattern"
            }
          }
        },
        "additionalProperties": false
      },
      "ForbiddenUsesRuleConfig": {
        "description": "Rule configuration for the `forbidden-uses` audit.",
        "type": "object",
        "properties": {
          "config": {
            "description": "Audit-specific configuration. Specify either `allow` or `deny`, not both.",
            "anyOf": [
              {
                "$ref": "#/definitions/ForbiddenUsesConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "disable": {
            "type": [
              "boolean",
              "null"
            ]
          },
          "ignore": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "$ref": "#/definitions/WorkflowRule"
            }
          }
        },
        "additionalProperties": false
      },
      "RepositoryUsesPattern": {
        "description": "A pattern for matching GitHub Actions repository uses. Patterns can be: '*' (any), 'owner/*' (any repo under owner), 'owner/repo' (exact repo), 'owner/repo/*' (any path in repo), 'owner/repo/path' (exact path), or 'owner/repo@ref' (exact ref)",
        "type": "string"
      },
      "RulesConfig": {
        "description": "Configuration for all audit rules.",
        "type": "object",
        "properties": {
          "anonymous-definition": {
            "description": "workflow or action definition without a name",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "archived-uses": {
            "description": "action or reusable workflow from archived repository",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "artipacked": {
            "description": "credential persistence through GitHub Actions artifacts",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "bot-conditions": {
            "description": "spoofable bot actor check",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "cache-poisoning": {
            "description": "runtime artifacts potentially vulnerable to a cache poisoning attack",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "concurrency-limits": {
            "description": "insufficient job-level concurrency limits",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "dangerous-triggers": {
            "description": "use of fundamentally insecure workflow trigger",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "dependabot-cooldown": {
            "description": "insufficient cooldown in Dependabot updates",
            "anyOf": [
              {
                "$ref": "#/definitions/DependabotCooldownRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "dependabot-execution": {
            "description": "external code execution in Dependabot updates",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "excessive-permissions": {
            "description": "overly broad permissions",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "forbidden-uses": {
            "description": "forbidden action used",
            "anyOf": [
              {
                "$ref": "#/definitions/ForbiddenUsesRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "github-env": {
            "description": "dangerous use of environment file",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "hardcoded-container-credentials": {
            "description": "hardcoded credential in GitHub Actions container configurations",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "impostor-commit": {
            "description": "commit with no history in referenced repository",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "insecure-commands": {
            "description": "execution of insecure workflow commands is enabled",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "known-vulnerable-actions": {
            "description": "action has a known vulnerability",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "obfuscation": {
            "description": "obfuscated usage of GitHub Actions features",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "overprovisioned-secrets": {
            "description": "excessively provisioned secrets",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "ref-confusion": {
            "description": "git ref for action with ambiguous ref type",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "ref-version-mismatch": {
            "description": "detects commit SHAs that don't match their version comment tags",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "secrets-inherit": {
            "description": "secrets unconditionally inherited by called workflow",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "self-hosted-runner": {
            "description": "runs on a self-hosted runner",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "stale-action-refs": {
            "description": "commit hash does not point to a Git tag",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "template-injection": {
            "description": "code injection via template expansion",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "undocumented-permissions": {
            "description": "permissions without explanatory comments",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "unpinned-images": {
            "description": "unpinned image references",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "unpinned-uses": {
            "description": "unpinned action reference",
            "anyOf": [
              {
                "$ref": "#/definitions/UnpinnedUsesRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "unredacted-secrets": {
            "description": "leaked secret values",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "unsound-condition": {
            "description": "unsound conditional expression",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "unsound-contains": {
            "description": "unsound contains condition",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "use-trusted-publishing": {
            "description": "prefer trusted publishing for authentication",
            "anyOf": [
              {
                "$ref": "#/definitions/BaseRuleConfig"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "additionalProperties": false
      },
      "UnpinnedUsesConfig": {
        "description": "Configuration specific to the `unpinned-uses` audit.",
        "type": "object",
        "properties": {
          "policies": {
            "description": "A mapping of action patterns to pinning policies.",
            "type": "object",
            "additionalProperties": {
              "$ref": "#/definitions/UsesPolicy"
            }
          }
        },
        "additionalProperties": false
      },
      "UnpinnedUsesRuleConfig": {
        "description": "Rule configuration for the `unpinned-uses` audit.",
        "type": "object",
        "properties": {
          "config": {
            "description": "Audit-specific configuration.",
            "anyOf": [
              {
                "$ref": "#/definitions/UnpinnedUsesConfig"
              },
              {
                "type": "null"
              }
            ]
          },
          "disable": {
            "type": [
              "boolean",
              "null"
            ]
          },
          "ignore": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "$ref": "#/definitions/WorkflowRule"
            }
          }
        },
        "additionalProperties": false
      },
      "UsesPolicy": {
        "description": "A singular policy for a `uses:` reference.",
        "oneOf": [
          {
            "description": "No policy; all `uses:` references are allowed, even unpinned ones.",
            "type": "string",
            "enum": [
              "any"
            ]
          },
          {
            "description": "`uses:` references must be pinned to a tag, branch, or hash ref.",
            "type": "string",
            "enum": [
              "ref-pin"
            ]
          },
          {
            "description": "`uses:` references must be pinned to a hash ref.",
            "type": "string",
            "enum": [
              "hash-pin"
            ]
          }
        ]
      },
      "WorkflowRule": {
        "description": "A workflow ignore rule in the format: filename.yml, filename.yml:line, or filename.yml:line:col",
        "type": "string",
        "pattern": "^[^:]+\\.ya?ml(:[1-9][0-9]*)?(:[1-9][0-9]*)?$"
      }
    }
  }
  