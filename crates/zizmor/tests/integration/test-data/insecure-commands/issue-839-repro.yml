on: pull_request

name: issue-839-repro

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: ${{ github.base_ref == main }}

permissions: {}

jobs:
  some-dangerous-job:
    name: some-dangerous-job
    runs-on: ubuntu-latest
    env:
      ACTIONS_ALLOW_UNSECURE_COMMANDS: "true"
    steps:
      - run: echo "don't do this"

  env-via-matrix:
    name: env-via-matrix
    runs-on: ubuntu-latest
    strategy:
      matrix:
        env:
          - ACTIONS_ALLOW_UNSECURE_COMMANDS: "   true"

    steps:
      - run: echo "don't do this"
        env: ${{ matrix.env }}

  this-is-ok-1:
    name: this-is-ok-1
    runs-on: ubuntu-latest
    steps:
      - run: echo "this is ok"
        env:
          ACTIONS_ALLOW_UNSECURE_COMMANDS: false

  this-is-ok-2:
    name: this-is-ok-2
    runs-on: ubuntu-latest
    steps:
      - run: echo "this is ok"
        env:
          ACTIONS_ALLOW_UNSECURE_COMMANDS: "false"

  this-is-ok-3:
    name: this-is-ok-3
    runs-on: ubuntu-latest
    steps:
      - run: echo "this is ok"
        env:
          ACTIONS_ALLOW_UNSECURE_COMMANDS: yes # does not evaluate to true
